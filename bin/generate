#!/usr/bin/env ruby

require "yaml"
require "erb"

def main
  ensure_output_directory
  config[:profiles].each do |profile, data|
    File.open(File.join("output", "#{profile}.html"), "w") do |file|
      file.write ERB.new(template).result(binding)
    end
  end
end

def ensure_output_directory
  Dir.mkdir("output") unless Dir.exist?("output")
end

def template
  File.read("templates/index.html.erb")
end

def config
  @config ||= YAML.load(File.open("config.yml"))
end

main
